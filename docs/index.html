<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="ipburack - Fast IP geolocation API in Go">
  <title>ipburack</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Anybody:wght@400;800&family=IBM+Plex+Mono:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="nav">
    <a href="https://github.com/burakcan/ipburack" class="nav-link">GitHub</a>
    <button class="theme-btn" id="themeToggle" aria-label="Toggle theme"></button>
  </nav>

  <header class="header">
    <h1 class="title">ipburack</h1>
    <p class="subtitle">IP → Country at <em>50k req/s</em></p>
  </header>

  <section class="demo">
    <div class="terminal">
      <div class="terminal-line">
        <span class="prompt">$</span> curl localhost:3002/lookup/8.8.8.8
      </div>
      <div class="terminal-output">{"country_code": "US"}</div>
      <div class="terminal-line">
        <span class="prompt">$</span> curl "localhost:3002/lookup/8.8.8.8?pc=true"
      </div>
      <div class="terminal-output">{"country_code": "US", "postal_code": "10001"}</div>
    </div>
  </section>

  <section class="section">
    <h2>Get it running</h2>
    <pre><code>docker compose up -d</code></pre>
    <p>That's it. Databases download automatically.</p>
  </section>

  <section class="section">
    <h2>Endpoints</h2>

    <div class="api-block">
      <div class="api-row">
        <code class="api-path">GET /lookup/{ip}</code>
        <span class="api-desc">Country code for any IP</span>
      </div>
      <div class="api-row">
        <code class="api-path">GET /lookup/{ip}?pc=true</code>
        <span class="api-desc">+ postal code</span>
      </div>
      <div class="api-row">
        <code class="api-path">GET /lookup</code>
        <span class="api-desc">Your IP (auto-detect)</span>
      </div>
      <div class="api-row">
        <code class="api-path">GET /health</code>
        <span class="api-desc">Health check</span>
      </div>
    </div>

    <div class="errors">
      <code>400</code> invalid IP
      <code>401</code> bad key
      <code>404</code> not found
    </div>
  </section>

  <section class="section">
    <h2>Auth</h2>
    <pre><code>API_KEY=secret docker compose up -d
curl -H "X-API-Key: secret" localhost:3002/lookup/8.8.8.8</code></pre>
    <p>Leave empty to disable. <code>/health</code> is always public.</p>
  </section>

  <section class="section">
    <h2>Config</h2>
    <div class="config">
      <div><code>HOST</code> <span>0.0.0.0</span></div>
      <div><code>PORT</code> <span>3002</span></div>
      <div><code>COUNTRY_DB_PATH</code> <span>/data/country.mmdb</span></div>
      <div><code>CITY_DB_IPV4_PATH</code> <span>/data/city-ipv4.mmdb</span></div>
      <div><code>CITY_DB_IPV6_PATH</code> <span>/data/city-ipv6.mmdb</span></div>
      <div><code>UPDATE_INTERVAL_HOURS</code> <span>24</span></div>
      <div><code>API_KEY</code> <span>—</span></div>
    </div>
  </section>

  <section class="section">
    <h2>Under the hood</h2>
    <ul>
      <li><b>MMDB</b> — memory-mapped, microsecond lookups</li>
      <li><b>Dual DB</b> — country for speed, city for postal codes</li>
      <li><b>Hot reload</b> — atomic pointer swap, zero downtime</li>
      <li><b>Auto-update</b> — refreshes every 24h</li>
    </ul>
  </section>

  <footer class="footer">
    <p>
      Data: <a href="https://github.com/sapics/ip-location-db">ip-location-db</a>
      (geolite2-geo-whois-asn-country + geolite2-city)
    </p>
    <p>Contains GeoLite2 data by <a href="https://www.maxmind.com">MaxMind</a></p>
    <p class="license">MIT</p>
  </footer>

  <script src="script.js"></script>
</body>
</html>
